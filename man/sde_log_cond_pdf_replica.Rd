% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/sde_replica.R
\name{sde_log_cond_pdf_replica}
\alias{sde_log_cond_pdf_replica}
\title{Replicator SDE: log conditional density (Euler--Maruyama)}
\usage{
sde_log_cond_pdf_replica(xt1, xt2, dt, drift, diffusion, tol = 1e-08)
}
\arguments{
\item{xt1}{Numeric length-2 vector: c(x1, x2).}

\item{xt2}{Numeric length-2 vector: c(x1, x2).}

\item{dt}{Positive numeric scalar, time step.}

\item{drift}{Numeric length-2 vector: c(r, s).}

\item{diffusion}{Positive numeric scalar: c.}

\item{tol}{Nonnegative numeric scalar, tolerance for simplex checks.}
}
\value{
Numeric scalar, log conditional density.
}
\description{
Two-sense replicator SDE with shared parameters:
\deqn{
dx_1 = x_1 (f_1 - \bar f)\, dt + c\, dW,\quad
dx_2 = x_2 (f_2 - \bar f)\, dt - c\, dW,
}
where
\deqn{
f_1 = r (1 - x_1 - s x_2),\quad
f_2 = r (1 - x_2 - s x_1),\quad
\bar f = x_1 f_1 + x_2 f_2.
}
}
\details{
Because x1 + x2 = 1, we compute the transition density for x1 and check the
simplex constraint:
\deqn{
x_{1,t+dt} | x_{1,t} \sim N(x_{1,t} + b_1(x_t) dt,\; dt c^2),
}
with \eqn{b_1(x_t) = x_1 (f_1 - \bar{f})}.
}
\examples{
# English comments only
result <- it1ws5_data_v2$entertain
dat <- result$df

set.seed(123)
chain <- sde_mcmc_fit(
  dat = dat,
  initial = rep(0.01, 3),
  nsteps = 2000,
  prior_max = 100,
  log_cond_pdf = sde_log_cond_pdf_replica
)

lp <- apply(chain, 1, function(p) sde_log_posterior(
  par = p, dat = dat, prior_max = 100, log_cond_pdf = sde_log_cond_pdf_replica
))
par_mean <- colMeans(tail(chain, 500))
par_mean
}
