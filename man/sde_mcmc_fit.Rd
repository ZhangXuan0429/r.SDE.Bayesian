% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/sde_core.R
\name{sde_mcmc_fit}
\alias{sde_mcmc_fit}
\title{Fit SDE parameters via MCMC (fmcmc)}
\usage{
sde_mcmc_fit(
  dat,
  initial = rep(0.01, 3),
  nsteps = 20000,
  prior_max = 100,
  log_cond_pdf = sde_log_cond_pdf,
  tol = 1e-08,
  kernel = fmcmc::kernel_ram()
)
}
\arguments{
\item{dat}{Data frame/matrix with columns: time, x1, x2.}

\item{initial}{Numeric vector length 3, initial parameters.}

\item{nsteps}{Integer, number of MCMC iterations.}

\item{prior_max}{Upper bound for Uniform prior on drift parameters.}

\item{log_cond_pdf}{Function computing log conditional density.}

\item{tol}{Tolerance for simplex checks.}

\item{kernel}{Proposal kernel from fmcmc, e.g., fmcmc::kernel_ram().}
}
\value{
MCMC chain matrix from fmcmc::MCMC().
}
\description{
Runs MCMC for \eqn{(r_1, \sigma_1, c)} using \code{sde_log_posterior()}.
You may supply a different \code{log_cond_pdf} to fit alternative drift forms
(e.g., replicator dynamics) under the same inference pipeline.
}
\examples{
# Example data: one polysemous word with two-sense proportion trajectory
result <- polysemous_data$entertain
dat <- result$df  # columns: time, x1, x2

set.seed(123)
# MCMC can be time-consuming; reduce steps for a quick example.
chain <- sde_mcmc_fit(
  dat = dat,
  initial = rep(0.01, 3),
  nsteps = 2000,
  prior_max = 100,
  log_cond_pdf = sde_log_cond_pdf,
  tol = 1e-8,
  kernel = fmcmc::kernel_ram()
)

# Log-posterior trace
lp <- apply(chain, 1, function(p) sde_log_posterior(p, dat = dat, prior_max = 100))

# Posterior mean of the last samples
par_mean <- colMeans(tail(chain, 500))
par_mean
}
